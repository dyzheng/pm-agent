{
  "task_id": "FE-102",
  "title": "NAO轨道生成（多zeta组合系统测试）",
  "specialist": "algorithm_agent",

  "goal": "为验证通过的稀土赝势生成多套数值原子轨道（NAO），系统测试不同zeta数和截断半径组合对计算精度的影响，确定推荐的默认轨道配置。",

  "context": {
    "problem": "ABACUS的LCAO基组需要预生成的NAO轨道文件。稀土元素的最优轨道组合不明确：f轨道极度局域化，可能需要较小的截断半径；但化学成键（f-d杂化）可能需要较大截断半径的尾巴。不同应用场景（体相 vs 表面 vs 分子）可能需要不同的轨道组合。",
    "tool": "ABACUS-orbitals（spillage最小化方法）。输入：赝势文件 + 参考DFT计算（PW基组）。输出：NAO轨道文件。",
    "orbital_notation": "SZ=单zeta, DZ=双zeta, TZ=三zeta, P=极化函数。例如DZP = 双zeta + 极化。对于稀土：基础通道是4f/5s/5p/5d/6s，极化通道可能是5f/6p/6d。"
  },

  "test_matrix": {
    "elements": ["Ce", "Gd", "La"],
    "zeta_configs": [
      {
        "name": "SZ",
        "description": "最小基组：每个通道1个zeta",
        "channels": "1s1p1d1f (La: 1s1p1d)",
        "expected_accuracy": "定性正确，定量误差较大"
      },
      {
        "name": "DZP",
        "description": "双zeta + 极化",
        "channels": "2s2p2d2f1g (La: 2s2p2d1f)",
        "expected_accuracy": "生产计算级别"
      },
      {
        "name": "TZDP",
        "description": "三zeta + 双极化",
        "channels": "3s3p3d3f2g (La: 3s3p3d2f)",
        "expected_accuracy": "高精度"
      }
    ],
    "cutoff_radii": [6, 7, 8, 9, 10],
    "unit": "Bohr",
    "notes": "截断半径对f通道特别敏感。f轨道本身在~2-3 Bohr内衰减，但化学环境可能需要更大的尾巴。"
  },

  "reference_calculations": {
    "description": "用PW基组做参考计算，作为spillage优化的目标",
    "systems": [
      {"formula": "CeO2", "kpoints": "4x4x4", "ecutwfc": "100 Ry"},
      {"formula": "GdN", "kpoints": "6x6x6", "ecutwfc": "100 Ry"},
      {"formula": "La2O3", "kpoints": "4x4x4", "ecutwfc": "100 Ry"}
    ],
    "properties_to_compare": [
      "总能量差 (LCAO - PW) per atom",
      "力的差异 (RMS force difference)",
      "带结构差异 (band structure comparison)",
      "电荷密度差异 (delta rho)"
    ]
  },

  "evaluation_criteria": {
    "energy": "LCAO vs PW总能量差 < 5 meV/atom (DZP), < 1 meV/atom (TZDP)",
    "force": "RMS力差 < 5 meV/Å (DZP), < 1 meV/Å (TZDP)",
    "band": "带结构主要特征（带隙、f带位置）定性一致",
    "efficiency": "记录每种配置的矩阵维度和计算时间"
  },

  "acceptance_criteria": [
    "Ce/Gd/La各至少DZP和TZDP两套轨道文件",
    "PW vs LCAO对比数据完整",
    "推荐的默认截断半径确定",
    "轨道文件格式正确，可被ABACUS读取"
  ]
}
